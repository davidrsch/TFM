# Apéndices Capítulo 2 {.unnumbered}

```{r}
#| output: asis
#| echo: false

empresas <- read_excel("data/000_empresas.xlsx") |>
  mutate(
    Seleccionadas = if_else(is.element(TICKERS,names(returns_emps3)),"X","")
  )
cat(md_table(empresas))
```

: Lista de empresas cotizadas {#tbl-emp_cotiz}

::: figure-caption
Obtenido de: La información expuesta en el sitio oficial de Bolsas y Mercados españoles, @BMEexcha.
:::

```{r}
#| output: asis
#| echo: false

entradas <- c(1,2,3)
obs <- dim(returns_indc[[1]])[1]
n_emp_sel <- length(returns_indc)
muestras <- data.frame(
  Entradas = entradas,
  `Muestras por empresa` = obs-(entradas-1+1),
  `Muestras totales` = (obs-(entradas-1+1)) * n_emp_sel
)
cat(md_table(muestras))
```

: Cantidades de muestras utilizadas para entrenar los modelos {#tbl-muestras}

::: figure-caption
Obtenido de: La información expuesta en el sitio oficial de Bolsas y Mercados españoles, @BMEexcha.
:::

```{r}
#| echo: false
#| warning: false
#| label: fig-tend_const_nxt
#| fig-alt: >
#|   Una gráfica que muestra la inconsistencia en el registro de los 
#|   precio de cierre ajustado de la serie correspondiente 
#|   a la empresa NUEVA EXPRESION TEXTIL, S.A., al observarse que 
#|   no existe variación del precio de cierre ajustado en periodo 
#|   correspondiente a 06-2009 al 04-2014.
#| cap-location: top
#| fig-cap: >
#|   Tendencia constante en los precios de cierre ajustado de la empresa "Nueva Expresión Textil S.A"

fig_df <- select_emps[["NXT.MC"]] |>
  mutate(Date = as.Date(Date))
ggplot(fig_df, aes(x=Date, y=Adjusted, group = 1)) +
  geom_line(color="#065AD8") +
  annotate(geom = 'point',x=fig_df$Date[142],y=2.6,size=26, shape=1, color="red")
```

::: figure-caption
Elaboración propia: A partir de los datos obtenidos de @yahoofin correspondientes a la empresa "Nueva Expreción Textil S.A" en el periodo del 31 de enero del 2000 al 28 de febrero del 2023.
:::

```{r}
#| echo: false
#| warning: false
#| label: fig-radi_chang_btc
#| fig-alt: >
#|   Una gráfica que muestra cambios bruscos en los precios de cierre 
#|   ajustado en relación al resto de valores de la serie, lo que puede 
#|   indicar un calculo erroneo de los valores durante cierto periodo de 
#|   tiempo.
#| cap-location: top
#| fig-cap: >
#|   Cambio brusco de precios que reflejan calculo erróneo de los precios de cierre ajustado, "BANKINTER,S.A."

fig_df <- select_emps[["BKT.MC"]] |>
  mutate(Date = as.Date(Date))
ggplot(fig_df, aes(x=Date, y=Adjusted, group = 1)) +
  geom_line(color="#065AD8") +
  annotate(geom = 'point',x=fig_df$Date[1],y=15,size=76, shape=1, color="red")
```

::: figure-caption
Elaboración propia: A partir de los datos obtenidos de @yahoofin correspondientes a la empresa "Nueva Expreción Textil S.A" en el periodo del 31 de enero del 2000 al 28 de febrero del 2023.
:::

::: {#fig-muestras}
::: {.content-visible when-format="html"}
<img src="images/a2_muestras.gif" class="img-fluid figure-img">
:::
::: {.content-visible when-format="docx"}
```{r, echo =FALSE}
knitr::include_graphics("images/a2_muestras.gif")
```
:::
::: {.content-visible when-format="pdf"}
[<img src="images/a2_muestras.gif">](https://gist.github.com/davidrsch/1f0b50446b5e54343b40831a87cde6bf)
:::
Visualización de vectores de entrada y salida
:::

::: figure-caption
Elaboración propia: Elaborada a partir de imagen en @chollet2018deep. Muestra como lucen los vectores tridimensionales de entradas y salidas correspondientes a los datos de una empresa, en el caso de que se usen tres observaciones para crear el vector de entrada.
:::
