<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2.2 Redes neuronais artificiais na previsión de series temporais – Traballo Fin de Máster</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./PC.html" rel="next">
<link href="./FSandP.html" rel="prev">
<link href="./../icologo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-23102fe0f0b5b1a9f09cc09ebcc8fe5b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sen resultados",
    "search-matching-documents-text": "documentos coincidentes",
    "search-copy-link-title": "Copiar ligazón para buscar",
    "search-hide-matches-text": "Ocultar coincidencias adicionais",
    "search-more-match-text": "máis coincidencias neste documento",
    "search-more-matches-text": "máis coincidencias neste documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #D60D8C;
      }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../my_style.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Cambiar navegación da barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./body.html">2 Desenvolvemento do traballo</a></li><li class="breadcrumb-item"><a href="./ANNinTSF.html">2.2 Redes neuronais artificiais na previsión de series temporais</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Cambiar navegación da barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./body.html">2 Desenvolvemento do traballo</a></li><li class="breadcrumb-item"><a href="./ANNinTSF.html">2.2 Redes neuronais artificiais na previsión de series temporais</a></li></ol></nav>
      <h1 class="title">2.2 Redes neuronais artificiais na previsión de series temporais</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Traballo Fin de Máster</a> 
        <div class="sidebar-tools-main tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-translate"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./../index.html">
            Español
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./../en/index.html">
            English
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-file-pdf"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./../pdf/Traballo Fin de Mestrado.pdf">
            Galego
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./../pdf/Master's Final Thesis.pdf">
            English
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./../pdf/Trabajo Final de Máster.pdf">
            Español
            </a>
          </li>
      </ul>
    </div>
    <a href="https://github.com/davidrsch/TFM" title="Código fonte" class="quarto-navigation-tool px-1" aria-label="Código fonte"><i class="bi bi-github"></i></a>
    <a href="https://twitter.com/intent/tweet?url=|url|" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descrición</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./greetings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grazas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summarygal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resumo</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summaryes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resumen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summaryen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abstract</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1 Introdución</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./body.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2 Desenvolvemento do traballo</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FSandP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.1 Caracterización de series temporais financeiras</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ANNinTSF.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">2.2 Redes neuronais artificiais na previsión de series temporais</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.3 Composición de carteiras</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.4 Datos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MandT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.5 Modelado e formación</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.6 Resultado</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 Conclusións</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliografía</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Anexos</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Annex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anexo. 1 Figuras</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Annex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anexo. 2 Gráficos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Annex3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anexo. 3 Taboleiros</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Annex4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anexo. 4 Códigos</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Táboa de contidos</h2>
   
  <ul>
  <li><a href="#antecedentes-sobre-o-uso-de-redes-neuronais-artificiais-na-predición-de-series-temporais" id="toc-antecedentes-sobre-o-uso-de-redes-neuronais-artificiais-na-predición-de-series-temporais" class="nav-link active" data-scroll-target="#antecedentes-sobre-o-uso-de-redes-neuronais-artificiais-na-predición-de-series-temporais">2.2.1 Antecedentes sobre o uso de redes neuronais artificiais na predición de series temporais</a></li>
  <li><a href="#redes-neuronais-convolucionais" id="toc-redes-neuronais-convolucionais" class="nav-link" data-scroll-target="#redes-neuronais-convolucionais">2.2.2 Redes neuronais convolucionais</a></li>
  <li><a href="#long-short-term-memory" id="toc-long-short-term-memory" class="nav-link" data-scroll-target="#long-short-term-memory">2.2.3 Long short-term memory</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/davidrsch/TFM/edit/master/gale/ANNinTSF.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta páxina</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Este epígrafe está dividido en tres subtítulos. O primeiro trata sobre os antecedentes do uso de redes neuronais artificiais para traballar con series temporais, máis concretamente na previsión. No segundo e terceiro subtítulo exponse o funcionamento de dúas das estruturas de capa de ANN utilizadas neste traballo, sendo estas a CNN e a LSTM.</p>
<section id="antecedentes-sobre-o-uso-de-redes-neuronais-artificiais-na-predición-de-series-temporais" class="level2">
<h2 class="anchored" data-anchor-id="antecedentes-sobre-o-uso-de-redes-neuronais-artificiais-na-predición-de-series-temporais">2.2.1 Antecedentes sobre o uso de redes neuronais artificiais na predición de series temporais</h2>
<p>En <span class="citation" data-cites="chollet2018deep">Chollet and Allaire (<a href="references.html#ref-chollet2018deep" role="doc-biblioref">2018</a>)</span> indícase que o entorno ANN está formado por intelixencia artificial (en diante IA), machine learning ou aprendizaxe automática (en diante ML) e deep learning ou aprendizaxe profunda (en diante DL), <a href="Annex1.html#fig-DLenv" class="quarto-xref">Figura&nbsp;<span>1</span></a>. Por iso, é de vital importancia coñecer os aspectos destes campos que están intimamente relacionados coa RNA e que se explican brevemente a continuación.</p>
<p>“Facer que unha máquina se comporte de tal forma que se o fixera un humano dirían que era intelixente” (<span class="citation" data-cites="McCarthy_Minsky_Rochester_Shannon_2006">McCarthy et al. (<a href="references.html#ref-McCarthy_Minsky_Rochester_Shannon_2006" role="doc-biblioref">2006</a>)</span>, p.11) é a primeira definición que se dá ao problema da IA. Co obxectivo de resolver este problema xurdiu a primeira IA, a chamada IA ​​simbólica.</p>
<p>Como explicaron <span class="citation" data-cites="haykin1998neural">Haykin (<a href="references.html#ref-haykin1998neural" role="doc-biblioref">1998</a>)</span>, <span class="citation" data-cites="banda2014">Banda (<a href="references.html#ref-banda2014" role="doc-biblioref">2014</a>)</span> e <span class="citation" data-cites="chollet2018deep">Chollet and Allaire (<a href="references.html#ref-chollet2018deep" role="doc-biblioref">2018</a>)</span>, estas primeiras IAs implicaban regras codificadas creadas polos programadores. Co obxectivo de conseguir que estas regras fosen aprendidas automaticamente polas máquinas ao observar os datos, xurdiu unha nova etapa no desenvolvemento da IA, a denominada ML. Esta nova etapa dá lugar á aparición dunha nova forma de programación, diferenciada da clásica, na medida en que, nesta, os programadores introducen os datos e as respostas esperadas aos mesmos, e os ordenadores son capaces de xerar as regras, <a href="Annex1.html#fig-MLprog" class="quarto-xref">Figura&nbsp;<span>2</span></a>.</p>
<p>Polo tanto, enténdese que os modelos de ML intentan atopar representacións axeitadas para os seus datos de entrada: transformacións dos datos que o fan máis apto para a tarefa en cuestión. En DL, que é un subcampo específico de ML, estas representacións de datos modelízanse mediante arquitecturas compostas por capas sucesivas, que se denominan ANN <span class="citation" data-cites="chollet2018deep">Chollet and Allaire (<a href="references.html#ref-chollet2018deep" role="doc-biblioref">2018</a>)</span>.</p>
<p>Despois de estudar o que se expuxo en <span class="citation" data-cites="haykin1998neural">Haykin (<a href="references.html#ref-haykin1998neural" role="doc-biblioref">1998</a>)</span>, <span class="citation" data-cites="Larranaga07">Larrañaga (<a href="references.html#ref-Larranaga07" role="doc-biblioref">2007</a>)</span>, <span class="citation" data-cites="banda2014">Banda (<a href="references.html#ref-banda2014" role="doc-biblioref">2014</a>)</span> e <span class="citation" data-cites="chollet2018deep">Chollet and Allaire (<a href="references.html#ref-chollet2018deep" role="doc-biblioref">2018</a>)</span> sobre ANN, pódese afirmar que están inspirados no funcionamento do cerebro humano, estes textos confirman e coinciden en que se poden distinguir nesta ANN tres tipos de capas. : entrada, saída e oculta. Unha capa de entrada está composta por neuronas que reciben os vectores de entrada. Unha capa de saída está formada por neuronas que, durante o adestramento, reciben os vectores de saída e despois xeran a resposta. Unha capa oculta está conectada ao ambiente a través das capas de entrada e saída, este tipo de capa oculta procesa a entrada recibida para obter a saída correspondente, <a href="Annex1.html#fig-RNAstruct" class="quarto-xref">Figura&nbsp;<span>3</span></a>.</p>
<p>Unha das aplicacións da ANN é a previsión de series temporais. cuxo obxectivo é predicir os valores futuros das variables en función das súas observacións pasadas. Como se comentou anteriormente, as series temporales financeiras adoitan ser non lineais, ruidosas, caóticas e non estacionarias, o que dificulta a súa modelización e previsión. As ANN teñen a vantaxe de poder captar relacións non lineais complexas e adaptarse ás condicións cambiantes sen esixir presupostos previos sobre a distribución ou estrutura dos datos.</p>
<p>A historia das ANN na previsión de series temporais financeiras remóntase a finais dos 80 e principios dos 90, cando os investigadores comezaron a explorar o potencial das ANN como alternativa aos métodos estatísticos tradicionais, como o modelo de media móbil autorregresiva integrada, máis coñecido como ARIMA. Autoregresivo Integrado Moving Average) e modelos autorregresivos xeneralizados con heterocedasticidade condicional, máis coñecidos como GARCH (Heterocedasticidade Condicional Autorregresiva Xeneralizada). Demostrouse que as ANN teñen varias vantaxes sobre estes métodos, como a capacidade de capturar relacións non lineais e dinámicas, manexar datos ruidosos e incompletos e adaptarse ás condicións cambiantes do mercado (<span class="citation" data-cites="ZHANG199835">B. Eddy Patuwo &amp; Michael Y. Hu (<a href="references.html#ref-ZHANG199835" role="doc-biblioref">1998</a>)</span>).</p>
<p>Non obstante, as ANN tamén se enfrontan a algunhas limitacións e desafíos na previsión de series temporais financeiras, como a dificultade de escoller unha arquitectura de rede adecuada, un algoritmo de adestramento, a función de activación e as variables de entrada; o risco de problemas de sobreadaptación e xeneralización; a falta de interpretabilidade e transparencia; e o alto custo e tempo computacional (<span class="citation" data-cites="TEALAB2018334">Tealab (<a href="references.html#ref-TEALAB2018334" role="doc-biblioref">2018</a>)</span>).</p>
<p>Para superar estas limitacións e desafíos, os investigadores propuxeron varias melloras e ampliacións de ANN para a previsión de series temporais financeiras nas últimas décadas. Algúns dos principais desenvolvementos inclúen:</p>
<ul>
<li><p>O uso de modelos híbridos que combinan ANN con outras técnicas como a lóxica difusa, algoritmos xenéticos, análise de wavelets, máquinas vectoriais de soporte e aprendizaxe profunda para mellorar o rendemento e a robustez da ANN (<span class="citation" data-cites="wongguo2010">Wong and Guo (<a href="references.html#ref-wongguo2010" role="doc-biblioref">2010</a>)</span>).</p></li>
<li><p>O uso de redes neuronais recorrentes (en diante RNR) ou bidireccionais, que son un tipo especial de ANN que poden procesar datos secuenciais e capturar dependencias temporais. Demostrouse que os RNR superan as redes neuronais unidireccionais en series temporales complexas e non lineais (<span class="citation" data-cites="GURESEN201110389">Guresen, Kayakutlu, and Daim (<a href="references.html#ref-GURESEN201110389" role="doc-biblioref">2011</a>)</span>).</p></li>
<li><p>O uso de modelos de ANN máis complexos mediante a combinación de diferentes capas, como redes neuronais convolucionais (en diante, CNN), long short-term memory (en diante, LSTM), gated recurrent units (en diante GRU) aplicouse á previsión de series temporais financeiras con resultados prometedores (<span class="citation" data-cites="SEZER2020106181">Sezer, Gudelek, and Ozbayoglu (<a href="references.html#ref-SEZER2020106181" role="doc-biblioref">2020</a>)</span>).</p></li>
</ul>
<p>A historia das ANN na previsión de series temporais financeiras mostra que as ANN evolucionaron e melloraron co paso do tempo para facer fronte á complexidade e incerteza dos mercados financeiros. Non obstante, aínda persisten algúns dos desafíos e limitacións mencionados anteriormente, como o sobreaxuste, a xeneralización, a interpretabilidade, a robustez e o custo computacional.</p>
</section>
<section id="redes-neuronais-convolucionais" class="level2">
<h2 class="anchored" data-anchor-id="redes-neuronais-convolucionais">2.2.2 Redes neuronais convolucionais</h2>
<p>O modelo de ANN empregado neste traballo está composto por varias capas, sendo a máis importante a capa Conv1D, un tipo específico de CNN, e a capa LSTM, ambas as dúas mencionadas no subapartado anterior cando as estruturas ANN que máis se utilizan na actualidade. Esta subsección céntrase na Capa Conv1D, polo que se exploran os conceptos fundamentais para comprender o seu funcionamento, explicando a convolución, as redes neuronais convolucionais e Conv1D e o seu uso para a análise de series temporais. Ofrécese unha visión xeral da convolución e como se pode aplicar aos datos de series temporais. Despois, fálase das CNN e da súa arquitectura, que lles permite aprender automaticamente funcións a partir de datos de series temporais. Finalmente, explícase Conv1D, un tipo específico de capa de rede neuronal convolucional que é particularmente eficaz para procesar datos de series temporais.</p>
<p>Como se comenta en <span class="citation" data-cites="rafid23">Siddiqui (<a href="references.html#ref-rafid23" role="doc-biblioref">2023</a>)</span>, a convolución é unha operación matemática que se usa habitualmente no procesamento de sinal e análise de imaxes. Implica tomar dúas funcións e producir unha terceira función que representa como unha das funcións orixinais modifica a outra. No contexto dos datos de series temporais, a convolución pódese usar para extraer características dos datos aplicando un filtro á serie temporal.</p>
<p>Ademais de extraer funcións dos datos de series temporais, a convolución tamén se pode usar para outras tarefas como a redución de ruído, a detección de anomalías e a predición. Por exemplo, unha CNN pódese adestrar para predecir os valores futuros dunha serie temporal aprendendo os patróns subxacentes nos datos. En xeral, a convolución é unha poderosa ferramenta para analizar datos de series temporais e as súas aplicacións son numerosas <span class="citation" data-cites="rafid23">Siddiqui (<a href="references.html#ref-rafid23" role="doc-biblioref">2023</a>)</span>.</p>
<p>As CNN introducíronse por primeira vez en <span class="citation" data-cites="cnn">Lecun et al. (<a href="references.html#ref-cnn" role="doc-biblioref">1998</a>)</span> e son un tipo de modelo de aprendizaxe profunda que se usa habitualmente para a análise de imaxes. Non obstante, como se mencionou anteriormente, tamén se poden usar para a análise de series temporais, xa que son moi axeitados para aprender características a partir de datos que teñen unha estrutura espacial ou temporal.</p>
<p>A arquitectura dunha CNN consta dunha ou máis capas convolucionais, que aplican filtros aos datos de entrada para extraer características. Cada filtro é un conxunto de pesos que se aprenden durante o proceso de adestramento. Ao desprazar o filtro sobre os datos de entrada, a capa convolucional calcula un produto puntual en cada posición, producindo un novo mapa de características <span class="citation" data-cites="cnn">Lecun et al. (<a href="references.html#ref-cnn" role="doc-biblioref">1998</a>)</span>.</p>
<p>Nun contexto de series temporais, unha CNN pode aprender a extraer automaticamente características dos datos a diferentes escalas e intervalos de tempo, o que o converte nunha poderosa ferramenta para a análise de series temporais. Unha vantaxe fundamental de usar unha CNN para a análise de series temporais é que reduce a necesidade de enxeñería manual de funcións. En lugar de deseñar filtros a man, CNN aprende a extraer automaticamente funcións dos datos, facéndoos máis flexibles e adaptables a diferentes tipos de datos de series temporais.</p>
<p>En xeral, a arquitectura dunha CNN permítelle aprender automaticamente características dos datos de series temporais, o que o converte nunha poderosa ferramenta para a análise de series temporais, sendo Conv1D unha das estruturas de CNN máis utilizadas para esta tarefa.</p>
<p>Como se explica en <span class="citation" data-cites="hongj20">Jing (<a href="references.html#ref-hongj20" role="doc-biblioref">2020</a>)</span>, Conv1D é un tipo específico de capa CNN que está deseñada para procesar datos unidimensionales, como datos de series temporais. Mentres que as CNN tradicionais están deseñadas para procesar datos bidimensionais, Conv1D está optimizado especificamente para datos unidimensionais, o que o fai máis eficiente e eficaz para a análise de series temporais.</p>
<p>A arquitectura dunha capa Conv1D é similar á dunha CNN tradicional, pero con algunhas diferenzas clave. En lugar de usar filtros bidimensionais, Conv1D usa filtros unidimensionais, que se aplican á serie temporal de entrada para extraer características. As características que se extraen da cadea dependerán das diferentes configuracións utilizadas para a configuración do filtro e do número de filtros empregados, sendo a seguinte fórmula para calcular a cantidade de característica que extrae cada filtro: <a href="#eq-cnn-lout" class="quarto-xref">Ecuación&nbsp;<span>1</span></a> (<span class="citation" data-cites="hongj20">Jing (<a href="references.html#ref-hongj20" role="doc-biblioref">2020</a>)</span>):</p>
<p><span id="eq-cnn-lout"><span class="math display">\[
\begin{aligned}
L_{out} &amp;= \frac{L_{in} + 2*padding - dilation*(kerenel\_size - 1)-1}{stride} + 1 \\
\end{aligned}
\tag{1}\]</span></span></p>
<p>Onde:</p>
<div class="margin">
<p><em>Lout</em>: é a lonxitude da saída do proceso de filtrado ou o número de funcións.</p>
</div>
<div class="margin">
<p><em>Lin</em>: a lonxitude do vector de entrada, correspondente na análise de series temporais ao número de observacións que conteñen as mostras da serie temporal que se pasan ao filtro.</p>
</div>
<div class="margin">
<p><em>kernel_size</em>: é o tamaño do filtro, que define cantas observacións do vector de entrada se pasan ao filtro cada vez. <a href="Annex1.html#fig-HJks" class="quarto-xref">Figura&nbsp;<span>4</span></a> representa como o tamaño do filtro pode afectar a lonxitude do vector de saída.</p>
</div>
<div class="margin">
<p><em>stride</em>: representa o número de pasos ou observacións polos que se move a selección de observacións pasadas ao filtro. <a href="Annex1.html#fig-HJstride" class="quarto-xref">Figura&nbsp;<span>5</span></a> representa como o parámetro stride pode afectar a lonxitude do vector de saída.</p>
</div>
<div class="margin">
<p><em>dilation</em>: é a distancia das observacións que pasan polo filtro. <a href="Annex1.html#fig-HJdilation" class="quarto-xref">Figura&nbsp;<span>6</span></a> representa como o parámetro de dilatación pode afectar a lonxitude do vector de saída.</p>
</div>
<div class="margin">
<p><em>padding</em>: representa o número de ceros a engadir a cada extremo do vector. <a href="Annex1.html#fig-HJpadding" class="quarto-xref">Figura&nbsp;<span>7</span></a> representa como o parámetro de recheo pode afectar a lonxitude do vector de saída.</p>
</div>
<p>En xeral, Conv1D é unha poderosa ferramenta para procesar datos de series temporais e as súas vantaxes inclúen a eficiencia computacional e a capacidade de capturar dependencias de tempo nos datos. Os seus casos de uso son numerosos e abarcan diferentes campos, polo que é unha ferramenta valiosa para a análise de series temporais.</p>
</section>
<section id="long-short-term-memory" class="level2">
<h2 class="anchored" data-anchor-id="long-short-term-memory">2.2.3 Long short-term memory</h2>
<p>Esta subsección explica por que os LSTM son unha das estruturas ANN máis utilizadas na predición de series temporais, baseándose nunha breve explicación dos RNR e por que son útiles para resolver problemas de predición de series. as RNN, e o funcionamento de cada unha das capas que conforman a estrutura dunha capa LSTM.</p>
<p><span class="citation" data-cites="COlah15">Olah (<a href="references.html#ref-COlah15" role="doc-biblioref">2015</a>)</span> explica que unha RNN pode considerarse como varias copias da mesma rede, <a href="Annex1.html#fig-CORNRstruct" class="quarto-xref">Figura&nbsp;<span>8</span></a>, afirma que este aspecto revela que os RNR están íntimamente relacionados con secuencias e listas, o que fai que este tipo de ANN sexa o que naturalmente se utiliza para traballar con series temporais.</p>
<p>Os RNR convencionais presentan un problema en relación coa capacidade de reter información, como explica <span class="citation" data-cites="COlah15">Olah (<a href="references.html#ref-COlah15" role="doc-biblioref">2015</a>)</span>, os RNN estándar só funcionan con gran capacidade se a información relevante para a situación actual é recente, é dicir, onde a brecha entre a información relevante e onde se é necesario é pequeno, <a href="Annex1.html#fig-CORInclose" class="quarto-xref">Figura&nbsp;<span>9</span></a>; ademais expón que a medida que a brecha crece, os RNN estándar non poden acceder á información relevante, <a href="Annex1.html#fig-CORInaway" class="quarto-xref">Figura&nbsp;<span>10</span></a>.</p>
<p>Como se mencionou anteriormente, os LSTM son un tipo de RNR que pode aprender dependencias a longo prazo dos datos secuenciais. Estes foron propostos en <span class="citation" data-cites="SeppJur97">Hochreiter (<a href="references.html#ref-SeppJur97" role="doc-biblioref">1997</a>)</span> e foron moi utilizados para varias tarefas como modelado de linguaxe, recoñecemento de voz, tradución automática, descrición de imaxes e previsión de series temporais.</p>
<p>A idea principal de LSTM é introducir unha célula de memoria que poida almacenar e actualizar información en pasos longos. A cela de memoria está controlada por tres portas: unha porta de entrada, unha porta de esquecemento e unha porta de saída. Estas portas son redes neuronais que aprenden a regular o fluxo de información dentro e fóra da célula <a href="Annex1.html#fig-CODrnrlstm" class="quarto-xref">Figura&nbsp;<span>11</span></a>.</p>
<p>A porta de entrada decide canto da nova entrada engadir ao estado da cela. A porta de esquecemento decide que parte do estado da cela anterior manter ou eliminar. A porta de saída decide que parte do estado da cela actual se enviará á seguinte capa. <span class="citation" data-cites="COlah15">Olah (<a href="references.html#ref-COlah15" role="doc-biblioref">2015</a>)</span> baseándose no exposto en <span class="citation" data-cites="SeppJur97">Hochreiter (<a href="references.html#ref-SeppJur97" role="doc-biblioref">1997</a>)</span>, describe o funcionamento das portas en catro pasos:</p>
<ol type="1">
<li>Decidir que información do estado da cela se esquece a través da porta, esquece a capa de porta <span class="math inline">\(f_t\)</span>. Esta porta mira <span class="math inline">\(h_{t-1}\)</span>, estado oculto do período de tempo anterior, e <span class="math inline">\(x_{t}\)</span>, entrada do instante de tempo actual, e mostra un número entre 0 (desfacer) e 1 (mantener) . para cada número no estado da cela <span class="math inline">\(C_{t-1}\)</span>, <a href="Annex1.html#fig-COLSTMstep1" class="quarto-xref">Figura&nbsp;<span>12</span></a>, <a href="#eq-lstm-fstep" class="quarto-xref">Ecuación&nbsp;<span>2</span></a>.</li>
</ol>
<p><span id="eq-lstm-fstep"><span class="math display">\[
\begin{aligned}
f_t &amp;= \sigma(W_f [h_{t-1}, x_t] + b_f) \\
\end{aligned}
\tag{2}\]</span></span></p>
<ol start="2" type="1">
<li>Decidir que información nova se almacena no estado da cela. Para isto primeiro, a capa de porta de entrada decide que valores actualizar e despois unha capa tanh (tanxente hiperbólica) crea un vector de novos valores candidatos (<span class="math inline">\(\tilde{C}_t\)</span>) que se poden engadir ao estado, <a href="Annex1.html#fig-COLSTMstep2" class="quarto-xref">Figura&nbsp;<span>13</span></a>, <a href="#eq-lstm-sstepf" class="quarto-xref">Ecuación&nbsp;<span>3</span></a> y <a href="#eq-lstm-ssteps" class="quarto-xref">Ecuación&nbsp;<span>4</span></a>.</li>
</ol>
<p><span id="eq-lstm-sstepf"><span class="math display">\[
\begin{aligned}
i_t &amp;= \sigma(W_i [h_{t-1}, x_t] + b_i) \\
\end{aligned}
\tag{3}\]</span></span></p>
<p><span id="eq-lstm-ssteps"><span class="math display">\[
\begin{aligned}
\tilde{C}_t &amp;= tanh(W_c [h_{t-1}, x_t] + b_c) \\
\end{aligned}
\tag{4}\]</span></span></p>
<ol start="3" type="1">
<li>O estado da cela antiga, <span class="math inline">\(C_{t-1}\)</span>, actualízase ao novo estado da cela <span class="math inline">\(C_{t}\)</span>. Multiplica o estado anterior por <span class="math inline">\(f_{t}\)</span>, esquecendo o que é necesario, despois engade <span class="math inline">\(i_{t} * \tilde{C}_{t}\)</span>. Estes son os novos valores candidatos, escalados pola cantidade de cada valor de estado que se debe actualizar, <a href="Annex1.html#fig-COLSTMstep3" class="quarto-xref">Figura&nbsp;<span>14</span></a>, <a href="#eq-lstm-tstep" class="quarto-xref">Ecuación&nbsp;<span>5</span></a>.</li>
</ol>
<p><span id="eq-lstm-tstep"><span class="math display">\[
\begin{aligned}
C_t &amp;= f_t * C_{t-1} + i_t * \tilde{C}_t  \\
\end{aligned}
\tag{5}\]</span></span></p>
<ol start="4" type="1">
<li>Xérase unha saída en función do estado da cela. Executar primeiro unha capa sigmoide que decide que partes do estado da célula é a saída; entón o estado da cela pásase a través dunha función tanh (escalando os valores entre -1 e 1) e multiplícase pola saída da porta, porta de saída, <a href="Annex1.html#fig-COLSTMstep4" class="quarto-xref">Figura&nbsp;<span>15</span></a>, <a href="#eq-lstm-fstepf" class="quarto-xref">Ecuación&nbsp;<span>6</span></a> y <a href="#eq-lstm-fsteps" class="quarto-xref">Ecuación&nbsp;<span>7</span></a>.</li>
</ol>
<p><span id="eq-lstm-fstepf"><span class="math display">\[
\begin{aligned}
o_t &amp;= \sigma(W_o [h_{t-1}, x_t] + b_o) \\
\end{aligned}
\tag{6}\]</span></span> <span id="eq-lstm-fsteps"><span class="math display">\[
\begin{aligned}
h_t &amp;= o_t * tanh(C_t) \\
\end{aligned}
\tag{7}\]</span></span></p>
<p>Os LSTM poden aprender a capturar dependencias a longo prazo axustando os valores de porta a través da propagación posterior. Por exemplo, se unha determinada entrada é relevante para unha saída posterior, a porta de entrada aprenderá a deixala entrar e a porta esquecida aprenderá a mantela no estado da cela ata que sexa necesaria. Pola contra, se unha entrada é irrelevante ou obsoleta, a pasarela aprenderá a ignorala e a porta esquecida aprenderá a eliminala do estado da cela.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-ZHANG199835" class="csl-entry" role="listitem">
B. Eddy Patuwo &amp; Michael Y. Hu, Guoqiang Zhang &amp;. 1998. <span>“Forecasting with Artificial Neural Networks:: The State of the Art.”</span> <em>International Journal of Forecasting</em> 14 (1): 35–62. https://doi.org/<a href="https://doi.org/10.1016/S0169-2070(97)00044-7">https://doi.org/10.1016/S0169-2070(97)00044-7</a>.
</div>
<div id="ref-banda2014" class="csl-entry" role="listitem">
Banda, Hugo. 2014. <em>Inteligencia Artificial: Principios y Aplicaciones</em>. Quito, Ecuador: Escuela Politécnica Nacional.
</div>
<div id="ref-chollet2018deep" class="csl-entry" role="listitem">
Chollet, F., and J. J. Allaire. 2018. <em>Deep Learning with r</em>. Manning Publications. <a href="https://books.google.es/books?id=xnIRtAEACAAJ">https://books.google.es/books?id=xnIRtAEACAAJ</a>.
</div>
<div id="ref-GURESEN201110389" class="csl-entry" role="listitem">
Guresen, Erkam, Gulgun Kayakutlu, and Tugrul U. Daim. 2011. <span>“Using Artificial Neural Network Models in Stock Market Index Prediction.”</span> <em>Expert Systems with Applications</em> 38 (8): 10389–97. https://doi.org/<a href="https://doi.org/10.1016/j.eswa.2011.02.068">https://doi.org/10.1016/j.eswa.2011.02.068</a>.
</div>
<div id="ref-haykin1998neural" class="csl-entry" role="listitem">
Haykin, Simon. 1998. <em>Neural Networks: A Comprehensive Foundation</em>. Prentice Hall PTR.
</div>
<div id="ref-SeppJur97" class="csl-entry" role="listitem">
Hochreiter, Jürgen, Sepp &amp; Schmidhuber. 1997. <span>“<span>Long Short-Term Memory</span>.”</span> <em>Neural Computation</em> 9 (8): 1735–80. <a href="https://doi.org/10.1162/neco.1997.9.8.1735">https://doi.org/10.1162/neco.1997.9.8.1735</a>.
</div>
<div id="ref-hongj20" class="csl-entry" role="listitem">
Jing, Hong. 2020. <span>“How Convolutional Layers Work in Deep Learning Neural Networks?”</span> Jingles, Github Blog. 2020. <a href="https://jinglescode.github.io/2020/11/01/how-convolutional-layers-work-deep-learning-neural-networks/">https://jinglescode.github.io/2020/11/01/how-convolutional-layers-work-deep-learning-neural-networks/</a>.
</div>
<div id="ref-Larranaga07" class="csl-entry" role="listitem">
Larrañaga, Iñaki &amp; Moujahid, Pedro &amp; Inza. 2007. <span>“Tema 14. Redes Neuronales.”</span> Departamento de Ciencias de la Computaci´on e Inteligencia Artificial, Universidad del Pa´ıs Vasco–Euskal Herriko Unibertsitatea. 2007. <a href="http://www.sc.ehu.es/ccwbayes/docencia/mmcc/docs/t14-neuronales.pdf">http://www.sc.ehu.es/ccwbayes/docencia/mmcc/docs/t14-neuronales.pdf</a>.
</div>
<div id="ref-cnn" class="csl-entry" role="listitem">
Lecun, Y., L. Bottou, Y. Bengio, and P. Haffner. 1998. <span>“Gradient-Based Learning Applied to Document Recognition.”</span> <em>Proceedings of the IEEE</em> 86 (11): 2278–2324. <a href="https://doi.org/10.1109/5.726791">https://doi.org/10.1109/5.726791</a>.
</div>
<div id="ref-McCarthy_Minsky_Rochester_Shannon_2006" class="csl-entry" role="listitem">
McCarthy, John, Marvin L. Minsky, Nathaniel Rochester, and Claude E. Shannon. 2006. <span>“A Proposal for the Dartmouth Summer Research Project on Artificial Intelligence, August 31, 1955.”</span> <em>AI Magazine</em> 27 (4): 12. <a href="https://doi.org/10.1609/aimag.v27i4.1904">https://doi.org/10.1609/aimag.v27i4.1904</a>.
</div>
<div id="ref-COlah15" class="csl-entry" role="listitem">
Olah, Christopher. 2015. <span>“Understanding LSTM Networks.”</span> Colah’s blog. 2015. <a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">https://colah.github.io/posts/2015-08-Understanding-LSTMs/</a>.
</div>
<div id="ref-SEZER2020106181" class="csl-entry" role="listitem">
Sezer, Omer Berat, Mehmet Ugur Gudelek, and Ahmet Murat Ozbayoglu. 2020. <span>“Financial Time Series Forecasting with Deep Learning : A Systematic Literature Review: 2005–2019.”</span> <em>Applied Soft Computing</em> 90: 106181. https://doi.org/<a href="https://doi.org/10.1016/j.asoc.2020.106181">https://doi.org/10.1016/j.asoc.2020.106181</a>.
</div>
<div id="ref-rafid23" class="csl-entry" role="listitem">
Siddiqui, J. Rafid. 2023. <span>“Why Convolve? Understanding Convolution and Feature Extraction in Deep Networks.”</span> Medium, Towards Data Science. 2023. <a href="https://towardsdatascience.com/why-convolve-understanding-convolution-and-feature-extraction-in-deep-networks-ee45d1fdd17c">https://towardsdatascience.com/why-convolve-understanding-convolution-and-feature-extraction-in-deep-networks-ee45d1fdd17c</a>.
</div>
<div id="ref-TEALAB2018334" class="csl-entry" role="listitem">
Tealab, Ahmed. 2018. <span>“Time Series Forecasting Using Artificial Neural Networks Methodologies: A Systematic Review.”</span> <em>Future Computing and Informatics Journal</em> 3 (2): 334–40. https://doi.org/<a href="https://doi.org/10.1016/j.fcij.2018.10.003">https://doi.org/10.1016/j.fcij.2018.10.003</a>.
</div>
<div id="ref-wongguo2010" class="csl-entry" role="listitem">
Wong, W. K., and Z. X. Guo. 2010. <span>“<span class="nocase">A hybrid intelligent model for medium-term sales forecasting in fashion retail supply chains using extreme learning machine and harmony search algorithm</span>.”</span> <em>International Journal of Production Economics</em> 128 (2): 614–24. <a href="https://ideas.repec.org/a/eee/proeco/v128y2010i2p614-624.html">https://ideas.repec.org/a/eee/proeco/v128y2010i2p614-624.html</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script type="text/javascript">

  const elementWithauthor = document.querySelector('.quarto-title-meta-author');
  
  if(elementWithauthor){
    
    //Ad more description in title banner
    let TFMtitle = document.getElementById('title-block-header');
    let TFMtitlefc = TFMtitle.firstElementChild;
    let TFMtitlefcfc = TFMtitlefc.firstElementChild;
    const sublead = document.createElement('p');
      sublead.className = 'subtitle lead';
      sublead.id = 'sublead';
      sublead.textContent = "Máster Universitario en Banca e Finanzas Curso académico 2022/2023";
    const sub_sublead = document.createElement('p');
      sub_sublead.className = 'subtitle lead';
      sub_sublead.id='sub_sublead';
      sub_sublead.textContent = "Traballo Fin de Máster presentado na Facultade de Economía e Empresa da Universidade da Coruña para a obtención do Máster Universitario en Banca e Finanzas";
    const udclogo = document.createElement('p');
      udclogo.innerHTML='<img src="../udclogo.png" style="width: 25%;">'
    TFMtitlefcfc.appendChild(sublead);
    TFMtitlefcfc.appendChild(sub_sublead);
    TFMtitlefcfc.appendChild(udclogo);
    
    //Fix authoring info
    const authorsElement = document.querySelector('.quarto-title-meta-heading');
    authorsElement.textContent = "AUTOR";
    const authorsInfo = authorsElement.parentElement;
    const tutorname = authorsElement.cloneNode(true);
    tutorname.textContent = "TITOR";
    tutorname.style.marginTop = '0';
    const tutorafili = tutorname.cloneNode(true);
    tutorafili.textContent = "";
    authorsInfo.insertBefore(tutorafili, authorsInfo.children[4]);
    authorsInfo.insertBefore(tutorname, authorsInfo.children[4]);
    
  }else{
    let TFMtitle = document.getElementById('title-block-header');
    let TFMtitlefc = TFMtitle.firstElementChild;
    let TFMtitlefcfc = TFMtitlefc.firstElementChild;
    const sub_sublead = document.createElement('p');
      sub_sublead.className = 'subtitle lead';
      sub_sublead.id='sub_sublead';
      sub_sublead.textContent = 'Aplicación das redes neuronais artificiais e da programación cuadrática na xestión de carteiras';
    TFMtitlefcfc.appendChild(sub_sublead);
    
    
    
  }
</script>

<script>

// Read the HTML content from a file
async function readHTMLFile(filePath) {
  try {
    const response = await fetch(filePath);
    const htmlContent = await response.text();
    return htmlContent;
  } catch (error) {
    console.error('Error reading HTML file:', error);
    return null;
  }
}

// Main function to process the HTML file
async function processHtmlFile(filePath, patternToMatch, patternToReplace, replacement) {
  const htmlContent = await readHTMLFile(filePath);
  const idsToSearch = [];

  if (htmlContent) {
    const parser = new DOMParser();
    const doc = parser.parseFromString(htmlContent, 'text/html');

    const elementsWithMatchingIds = Array.from(doc.querySelectorAll('[id^="' + patternToMatch + '"]'));
    elementsWithMatchingIds.forEach(element => {
      const id = element.getAttribute('id');
      idsToSearch.push(id);
    });
  }

  const anchorElements = Array.from(document.querySelectorAll('a'));

  anchorElements.forEach(anchorElement => {
    const href = anchorElement.getAttribute('href');
    if (idsToSearch.some(id => href && href.endsWith(id))) {
      anchorElement.innerHTML = anchorElement.innerHTML.replace(patternToReplace, replacement);
    }
  });
}


const filePath = 'Annex2.html'; 
const patternToMatch = 'fig-'; 
const patternToReplace = 'Figura&nbsp;';
const replacement = 'Gráfico ';

processHtmlFile(filePath, patternToMatch, patternToReplace, replacement);
  
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiouse!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiouse!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./FSandP.html" class="pagination-link" aria-label="2.1 Caracterización de series temporais financeiras">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">2.1 Caracterización de series temporais financeiras</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./PC.html" class="pagination-link" aria-label="2.3 Composición de carteiras">
        <span class="nav-page-text">2.3 Composición de carteiras</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Traballo Fin de Máster presentado en <a href="https://fee.udc.es/"><img src="../feelogo.png" class="img-fluid" alt="FEE" width="65"></a> <a href="https://www.udc.es/"><img src="../udclogo.png" class="img-fluid" alt="UDC" width="65"></a></p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 David Díaz Rodríguez
  </li>  
</ul>
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/davidrsch/TFM/edit/master/gale/ANNinTSF.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta páxina</a></li></ul></div></div>
    <div class="nav-footer-right">
<p><a href="https://www.linkedin.com/in/david-d-6257951b8/"><img src="../sm/linkedin.png" width="20px" fig-alt="Linkeding profile"></a> <a href="https://github.com/davidrsch/TFM/"><img src="../sm/github.png" width="20px" fig-alt="Github repository"></a> <a href="https://www.researchgate.net/profile/David-Diaz-Rodriguez"><img src="../sm/Researchgate.png" width="20px" fig-alt="ResearchGate profile"></a> <a href="https://orcid.org/0000-0002-0927-9795"><img src="../sm/orcid.png" width="20px" fig-alt="ORCid profile"></a></p>
</div>
  </div>
</footer>




</body></html>