# Apéndices Capítulo 1 {.unnumbered}

```{r}
#| echo: false
#| message: false

library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(gridExtra)
library(quantmod)
library(forecast)
library(gt)

IBEX <- read.csv("data/IBEXm.csv")
```

| Variable dependiente | Subíndice Discreto                           | Subíndice Continuo                           |
|-------------------|---------------------------|---------------------------|
| Discreta             | Proceso de estado discreto y tiempo discreto | Proceso de estado discreto y tiempo continuo |
| Continua             | Proceso de estado continuo y tiempo discreto | Proceso de estado continuo y tiempo continuo |

: Clasificaciones de procesos estocásticos {#tbl-pro_esto}

::: figure-caption
Tomada de: @ruiz2011.
:::

```{r}
#| echo: false
#| label: tbl-pre_estruc
#| tbl-cap: Estructura de datos de precios
    
ITX <- read.csv('data/ITX.MC.csv')
ITX <- head(ITX)
gt(ITX)
```

::: figure-caption
Elaboración propia: Mediante el uso de RStudio con la base de datos histórico de "INDITEX", obtenida de https://finance.yahoo.com/, en el periodo comprendido entre el 24-05-2001 al 31-05-2001.
:::

```{r}
#| echo: false
#| warning: false
#| label: fig-tend_pos
#| fig-alt: >
#|   Una gráfica que muestra una tendencia alcista y heterocedástica.
#| cap-location: top
#| fig-cap: >
#|   Tendencia alcista y heterocedástica

IBEX |>
  filter(Date > "1995-01" & Date < "1997-01") |>
  mutate(Date = ym(Date)) |>
  ggplot(aes(x = Date, group = 1)) +
  geom_line(aes(y = CloseI), color = "black") +
  theme(axis.text.x = element_text(angle = 90)) +
  ylab("Precio de Cierre") +
  xlab("Fecha")
```

::: figure-caption
Elaboración propia: Mediante el uso de RStudio con la base de datos histórico del IBEX, obtenida de https://finance.yahoo.com/, en el periodo comprendido entre el 01-1995 al 01-1997.
:::

```{r}
#| echo: false
#| warning: false
#| label: fig-tend_neg
#| fig-alt: >
#|   Una gráfica que muestra una tendencia bajista y heterocedástica.
#| cap-location: top
#| fig-cap: >
#|   Tendencia bajista y heterocedástica

IBEX |>
  filter(Date > "2000-01" & Date < "2003-01") |>
  mutate(Date = ym(Date)) |>
  ggplot(aes(x = Date, group = 1)) +
  geom_line(aes(y = CloseI), color = "black") +
  theme(axis.text.x = element_text(angle = 90)) +
  ylab("Precio de Cierre") +
  xlab("Fecha")
```

::: figure-caption
Elaboración propia: Mediante el uso de RStudio con la base de datos histórico del IBEX, obtenida de https://finance.yahoo.com/, en el periodo comprendido entre el 01-2000 al 01-2003.
:::

```{r}
#| echo: false
#| warning: false
#| label: fig-tend_nul
#| fig-alt: >
#|   Una gráfica que muestra una tendencia bajista y heterocedástica.
#| cap-location: top
#| fig-cap: >
#|   Sin tendencia, homocedástica y estacionaria

IBEX |>
  mutate(CloseI = Delt(CloseI)) |>
  na.omit() |>
  filter(Date > "2000-01" & Date < "2003-01") |>
  mutate(Date = ym(Date)) |>
  ggplot(aes(x = Date, group = 1)) +
  geom_line(aes(y = CloseI), color = "black") +
  theme(axis.text.x = element_text(angle = 90)) +
  ylab("Rentabilida de Cierre") +
  xlab("Fecha")
```

::: figure-caption
Elaboración propia: Mediante el uso de RStudio con la base de datos histórico del IBEX obtenida de https://finance.yahoo.com/, en el periodo comprendido entre el 01-2000 al 01-2003, usando las rentabilidades calculadas a partir del precio de cierre.
:::

```{r}
#| echo: false
#| warning: false
#| label: fig-est_err
#| fig-alt: >
#|   Una gráfica que muestra los componentes de estacionalidad y error.
#| fig-cap: >
#|   Descomposición: estacionalidad y error

IBEXts <- IBEX |>
  filter(Date > "2000-01" & Date < "2023-01") |>
  select(CloseI) |>
  ts(frequency = 12) |>
  decompose()

pp1 <- IBEX |>
  filter(Date > "2000-01" & Date < "2023-01") |>
  mutate(seasonal = as.vector(IBEXts$seasonal)) |>
  mutate(Date = ym(Date)) |>
  ggplot(aes(x = Date, group = 1)) +
  geom_line(aes(y = seasonal), color = "black") +
  theme(axis.title.x = element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) +
  ylab("Estacionalidad") +
  xlab("Fecha")
pp2 <- IBEX |>
  filter(Date > "2000-01" & Date < "2023-01") |>
  mutate(Random = as.vector(IBEXts$random)) |>
  mutate(Date = ym(Date)) |>
  ggplot(aes(x = Date, group = 1)) +
  geom_line(aes(y = Random), color = "black") +
  theme(axis.text.x = element_text(angle = 90)) +
  ylab("Residuos") +
  xlab("Fecha")
grid.arrange(pp1, pp2, ncol = 1, heights = c(1.4, 2))
```

::: figure-caption
Elaboración propia: Mediante el uso de RStudio con la base de datos histórico del IBEX obtenida de https://finance.yahoo.com/, descomponiendo la serie de tiempo conformada por las observaciones que abarcan el periodo del 01-2000 al 01-2023.
:::

```{r}
#| echo: false
#| warning: false
#| label: fig-acf_pacf
#| fig-alt: >
#|   Correlogramas de autocorrelación y correlación parcial.
#| fig-cap: >
#|   Correlograma

ts <- IBEX |>
  filter(Date > "2000-01" & Date < "2023-01") |>
  select(CloseI) |>
  ts(frequency = 12)
grid.arrange(ggAcf(ts), ggPacf(ts), ncol = 2)
```

::: figure-caption
Elaboración propia: Mediante el uso de RStudio.
:::

![DLenv](images/a1_DL-env.png "Relación entre IA-ML-DL"){#fig-DLenv fig-alt="IA engloba a ML y ML engloba a DL"}

::: figure-caption
Tomada de: Deep learning with R de @chollet2018deep.
:::

![MLprog](images/a1_ML-prog.png "Programación clásica y machine learning"){#fig-MLprog fig-alt="Muestra un esquema que explica de manera general el paradigma de la programación clasica y el uso de machine learning. Mostrandose en el primero como se introducen reglas y datos para obtener respuestas, mientras que en machine learning se introducen datos y respuestas para obtener reglas"}

::: figure-caption
Tomada de: Deep learning with R de @chollet2018deep.
:::

![RNAstruct](images/a1_RNA-struct.png "Estructura básica de una red neuronal artificial"){#fig-RNAstruct fig-alt="Muestra un esquema el esquema de la estructura básica de una RNA. Se muestra como los diferentes las diferentes entradas se conectan a cada uno de los nodos de las capa oculta y a su vez como cada uno de los nodos de la capa oculta se conecta a los nodos de la capa de salida. Los nodos de la capa oculta y la capa de salida también están conectados a un parámetro bias "}

::: figure-caption
Tomada de: Tema 14: redes neuronales de @Larranaga07.
:::

![CORNRstruct](images/a1_CO-RNRstruct.png "Despliegue del bucle de una red neuronal recurrente estándar"){#fig-CORNRstruct}

::: figure-caption
Tomadas de: Understanding LSTM networks, @COlah15.
:::

![CORInclose](images/a1_CO-RInclose.png "Información relevante cercana"){#fig-CORInclose}

::: figure-caption
Tomadas de: Understanding LSTM networks, @COlah15.
:::

![CORInaway](images/a1_CO-RInaway.png "Información relevante cercana"){#fig-CORInaway}

::: figure-caption
Tomadas de: Understanding LSTM networks, @COlah15.
:::

![CODrnrlstm](images/a1_CO-Drnrlstm.png "Diferencia entre los módulos de repetición"){#fig-CODrnrlstm}

::: figure-caption
Tomadas de: Understanding LSTM networks, @COlah15.
:::

![COLSTMstep1](images/a1_CO-LSTMstep1.png "Representación del paso 1"){#fig-COLSTMstep1}

::: figure-caption
Tomadas de: Understanding LSTM networks, @COlah15.
:::

![COLSTMstep2](images/a1_CO-LSTMstep2.png "Representación del paso 2"){#fig-COLSTMstep2}

::: figure-caption
Tomadas de: Understanding LSTM networks, @COlah15.
:::

![COLSTMstep3](images/a1_CO-LSTMstep3.png "Representación del paso 3"){#fig-COLSTMstep3}

::: figure-caption
Tomadas de: Understanding LSTM networks, @COlah15.
:::

![COLSTMstep4](images/a1_CO-LSTMstep4.png "Representación del paso 4"){#fig-COLSTMstep4}

::: figure-caption
Tomadas de: Understanding LSTM networks, @COlah15.
:::